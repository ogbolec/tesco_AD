---
title: ""
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(readr)
Tesco <- read_csv("Tesco.csv")
```

# 1 Czyszczenie

### Braki danych

### Odstające

### Walidacja

### Sprawdzanie bazy pod kątem występowania wartości NA:

```{r}
#Sprawdzam czy w bazie istnieją jakieś wartości NA
paste('Suma wartości NA w bazie:',sum(is.na(Tesco)))
```

### Analiza zyskowności poszczególnych kategorii:

```{r}
library(dplyr)

Tesco_grouped <- Tesco %>%
  group_by(Category) %>%
  summarize(Total_Sales = sum(Sales),
            Total_quantity = sum(Quantity),
            Average_Profit = mean(Profit),
            Average_Profit_in_proc. = paste0(
              round(100*sum(Profit)/sum(Sales),2),'%'))


print(Tesco_grouped)

library(ggplot2)
library(scales)
ggplot(Tesco_grouped, aes(x = Category, y = Average_Profit)) +
  geom_bar(stat = "identity") 
```
